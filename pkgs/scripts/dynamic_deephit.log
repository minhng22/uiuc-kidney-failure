Train data path /home/minhn2/uiuc-kidney-failure/generated_data/egfr_tv_train_data.csv
Test data path /home/minhn2/uiuc-kidney-failure/generated_data/egfr_tv_test_data.csv
Number of patients: test 6842 and train 27365
Number of records: test 96894 and train 385752
Running Optuna hyperparameter optimization
[I 2025-04-13 20:41:41,430] A new study created in memory with name: no-name-276d0cae-fbb0-497d-b024-647410c27d47
Running trial 0 for ExperimentScenario.TIME_VARIANT on device cuda:1
Train data path /home/minhn2/uiuc-kidney-failure/generated_data/egfr_tv_train_data.csv
Test data path /home/minhn2/uiuc-kidney-failure/generated_data/egfr_tv_test_data.csv
Number of patients: test 6842 and train 27365
Number of records: test 96894 and train 385752
Epoch 1/50
features shape: torch.Size([256, 461, 1]), mask shape: torch.Size([256, 461]), time_to_event shape: torch.Size([256, 1]), event_indicator shape: torch.Size([256, 1]), time_to_events shape: torch.Size([256, 461]), event_indicators shape: torch.Size([256, 461]), sequence lengths shape: torch.Size([256, 1])
x shape: torch.Size([256, 461, 1])
mask shape: torch.Size([256, 461])
lstm_output shape: torch.Size([256, 461, 256])
fc_output shape: torch.Size([256, 461, 128])
context shape: torch.Size([256, 128])
attention_weights shape: torch.Size([256, 461, 1])
x shape after cause_specific_fc: torch.Size([256, 218])
hazard_preds shape: [torch.Size([256, 5475])]
res shape: torch.Size([256, 1, 5475])
Epoch 2/50
features shape: torch.Size([256, 461, 1]), mask shape: torch.Size([256, 461]), time_to_event shape: torch.Size([256, 1]), event_indicator shape: torch.Size([256, 1]), time_to_events shape: torch.Size([256, 461]), event_indicators shape: torch.Size([256, 461]), sequence lengths shape: torch.Size([256, 1])
x shape: torch.Size([256, 461, 1])
mask shape: torch.Size([256, 461])
lstm_output shape: torch.Size([256, 461, 256])
fc_output shape: torch.Size([256, 461, 128])
context shape: torch.Size([256, 128])
attention_weights shape: torch.Size([256, 461, 1])
x shape after cause_specific_fc: torch.Size([256, 218])
hazard_preds shape: [torch.Size([256, 5475])]
res shape: torch.Size([256, 1, 5475])
Epoch 3/50
features shape: torch.Size([256, 461, 1]), mask shape: torch.Size([256, 461]), time_to_event shape: torch.Size([256, 1]), event_indicator shape: torch.Size([256, 1]), time_to_events shape: torch.Size([256, 461]), event_indicators shape: torch.Size([256, 461]), sequence lengths shape: torch.Size([256, 1])
x shape: torch.Size([256, 461, 1])
mask shape: torch.Size([256, 461])
lstm_output shape: torch.Size([256, 461, 256])
fc_output shape: torch.Size([256, 461, 128])
context shape: torch.Size([256, 128])
attention_weights shape: torch.Size([256, 461, 1])
x shape after cause_specific_fc: torch.Size([256, 218])
hazard_preds shape: [torch.Size([256, 5475])]
res shape: torch.Size([256, 1, 5475])
